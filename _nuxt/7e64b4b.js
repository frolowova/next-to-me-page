(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{380:function(e,t,r){"use strict";r.r(t);var n={props:{title:String,color:{type:String,default:"primary"},outlined:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}}},l=r(45),o=r(50),c=r.n(o),d=r(357),component=Object(l.a)(n,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("v-btn",e._g({staticClass:"rounded-lg",attrs:{block:"",elevation:"2","x-large":"",color:e.color,outlined:e.outlined,disabled:e.disabled,loading:e.loading}},e.$listeners),[e._v("\n  "+e._s(e.title)+"\n")])}),[],!1,null,null,null);t.default=component.exports;c()(component,{VBtn:d.a})},437:function(e,t,r){"use strict";r(16),r(17);t.a={methods:{loadAndPreviewImages:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(t,n){var canvas=document.createElement("canvas"),img=document.createElement("img");img.addEventListener("load",(function(){var t=img.width,l=img.height,o=(null==r?void 0:r.width)||200,c=(null==r?void 0:r.height)||200;t>l?t>o&&(l=Math.round(l*=o/t),t=o):l>c&&(t=Math.round(t*=c/l),l=c),canvas.width=t,canvas.height=l,canvas.getContext("2d").drawImage(img,0,0,t,l);var d=canvas.toDataURL("image/jpeg",.8);e.attachedFiles.push({url:d,file:n})})),img.addEventListener("error",(function(){throw new Error("Compressed img error!")})),img.src=t};t.forEach((function(e){if("image/jpeg"===e.type||"image/png"===e.type){var t=new FileReader;t.addEventListener("load",(function(t){var r=t.target.result;n(r,e)})),t.readAsDataURL(e)}}))}}}},441:function(e,t,r){var content=r(552);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(25).default)("bdbe60e0",content,!0,{sourceMap:!1})},442:function(e,t,r){var content=r(554);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(25).default)("4f4b1760",content,!0,{sourceMap:!1})},550:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZGF0YS1uYW1lPSJMYXllciAyIj48ZyBkYXRhLW5hbWU9ImNsb3NlIj48cmVjdCB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHRyYW5zZm9ybT0icm90YXRlKDE4MCAxMiAxMikiIG9wYWNpdHk9IjAiLz48cGF0aCBkPSJNMTMuNDEgMTJsNC4zLTQuMjlhMSAxIDAgMSAwLTEuNDItMS40MkwxMiAxMC41OWwtNC4yOS00LjNhMSAxIDAgMCAwLTEuNDIgMS40Mmw0LjMgNC4yOS00LjMgNC4yOWExIDEgMCAwIDAgMCAxLjQyIDEgMSAwIDAgMCAxLjQyIDBsNC4yOS00LjMgNC4yOSA0LjNhMSAxIDAgMCAwIDEuNDIgMCAxIDEgMCAwIDAgMC0xLjQyeiIvPjwvZz48L2c+PC9zdmc+"},551:function(e,t,r){"use strict";var n=r(441);r.n(n).a},552:function(e,t,r){(t=r(24)(!1)).push([e.i,'.images-block[data-v-bb709dd6]{position:relative}.remove-img[data-v-bb709dd6]{position:absolute;right:10px;top:10px;cursor:pointer;z-index:1}.remove-img img[data-v-bb709dd6]{filter:drop-shadow(0 0 1px white)}.show-all[data-v-bb709dd6]{background:rgba(43,43,43,.4);position:relative;cursor:pointer}.show-all__info[data-v-bb709dd6]{z-index:1;position:absolute;text-align:center;top:50%;left:50%;transform:translate(-50%,-50%)}.show-all__info p[data-v-bb709dd6]{font-family:Roboto;font-style:normal;font-weight:400;font-size:14px;line-height:20px;letter-spacing:.16px;font-feature-settings:"pnum" on,"lnum" on;color:#fff}.show-all__info p+p[data-v-bb709dd6]{margin-top:20px}',""]),e.exports=t},553:function(e,t,r){"use strict";var n=r(442);r.n(n).a},554:function(e,t,r){(t=r(24)(!1)).push([e.i,".create-tag-form[data-v-b6c51784]{margin:auto}",""]),e.exports=t},570:function(e,t,r){"use strict";r.r(t);r(18),r(61),r(51),r(59),r(58);var n=r(382),l=r(437),o={props:{img:String}},c=r(45),d=r(50),f=r.n(d),m=r(240),v=r(158),h=r(405),component=Object(c.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"image-view"},[t("v-img",{staticClass:"grey lighten-2",attrs:{src:this.img,"aspect-ratio":"1"},scopedSlots:this._u([{key:"placeholder",fn:function(){return[t("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[t("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}])})],1)}),[],!1,null,null,null),x=component.exports;f()(component,{VImg:m.a,VProgressCircular:v.a,VRow:h.a});var w={components:{imageView:x},data:function(){return{isOpen:!1,close:r(550)}},props:{arrayOfPic:{type:Array,default:[]}},methods:{setOpen:function(){this.isOpen=!this.isOpen}}},y=(r(551),r(569)),M=Object(c.a)(w,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.isOpen||e.arrayOfPic.length<4?r("v-row",e._l(e.arrayOfPic,(function(img,i){return r("v-col",{key:i,staticClass:"d-flex child-flex images-block",attrs:{cols:"4"},on:{dblclick:function(t){return e.$emit("remove-image",i)}}},[r("imageView",{attrs:{img:img}}),e._v(" "),r("div",{staticClass:"remove-img",on:{click:function(t){return e.$emit("remove-image",i)}}},[r("img",{attrs:{src:e.close}})])],1)})),1):r("v-row",[e._l(e.arrayOfPic.slice(0,2),(function(img,i){return r("v-col",{key:i,staticClass:"d-flex child-flex images-block",attrs:{cols:"4"},on:{dblclick:function(t){return e.$emit("remove-image",i)}}},[r("imageView",{attrs:{img:img}}),e._v(" "),r("div",{staticClass:"remove-img",on:{click:function(t){return e.$emit("remove-image",i)}}},[r("img",{attrs:{src:e.close}})])],1)})),e._v(" "),r("v-col",[r("div",{staticClass:"show-all",on:{click:e.setOpen}},[r("div",{staticClass:"show-all__info"},[r("p",[e._v(e._s(e.arrayOfPic.length-3))]),e._v(" "),r("p",[e._v("Показать все")])]),e._v(" "),r("imageView",{attrs:{img:e.arrayOfPic[2]}})],1)])],2)],1)}),[],!1,null,"bb709dd6",null),C=M.exports;f()(M,{VCol:y.a,VRow:h.a});var _=r(34),I={components:{tagImages:C,NTMButton:r(380).default},mixins:[l.a],data:function(){return{valid:!0,loading:!1,tagText:"",selectedFiles:[],attachedFiles:[],rules:{required:function(e){return!!e||"Напишите-что нибудь"}},errorMessage:""}},computed:{totalFiles:function(){return this.selectedFiles.length+this.attachedFiles.length},arrayOfPic:function(){return this.attachedFiles.map((function(img){return img.url}))}},methods:{validate:function(){this.$refs.form.validate()},createTag:function(){var e=this;this.validate(),this.valid&&(this.loading=!0,this.$store.dispatch(_.SEND_MESSAGE,{text:this.tagText,photos:Object(n.a)(this.arrayOfPic)}).then((function(t){e.loading=!1,e.$router.push("/home")})).catch((function(t){e.loading=!1,e.errorMessage="Что-то пошло не так, попробуйте позже",setTimeout((function(){e.errorMessage=""}),3e3)})))},removeImage:function(e){this.attachedFiles=this.attachedFiles.filter((function(t,i){return i!==e}))},loadImageClickHandler:function(){this.$refs.fileInput.$children[0].$el.click()},onChangeFile:function(){if(this.selectedFiles.length){if(this.totalFiles>8)return alert("Вы не можете прикрепить больше 8 файлов!"),void(this.selectedFiles=[]);var e=Array.from(this.selectedFiles);this.selectedFiles=[],this.loadAndPreviewImages(e,{width:1200,height:900})}}}},A=(r(553),r(401)),k=r(543),j=r(394),O=r(503),D=Object(c.a)(I,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"create-tag-form mx-6 mt-4"},[r("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("span",{staticClass:"ml-2"},[e._v("Тег")]),e._v(" "),r("v-textarea",{staticClass:"rounded-xl mt-2",attrs:{"background-color":"cardBackground",solo:"","auto-grow":"",rules:[e.rules.required],placeholder:"Текст тега",autofocus:""},model:{value:e.tagText,callback:function(t){e.tagText=t},expression:"tagText"}}),e._v(" "),r("div",{staticClass:"images-block"},[r("tagImages",{attrs:{arrayOfPic:e.arrayOfPic},on:{"remove-image":e.removeImage}})],1),e._v(" "),e.errorMessage?r("v-alert",{attrs:{dense:"",text:"",type:"error"}},[e._v(e._s(e.errorMessage))]):e._e(),e._v(" "),r("div",{staticClass:"input-file-btn"},[r("v-file-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"fileInput",attrs:{accept:"image/x-png,image/jpeg,image/gif",multiple:""},on:{change:e.onChangeFile},model:{value:e.selectedFiles,callback:function(t){e.selectedFiles=t},expression:"selectedFiles"}}),e._v(" "),r("ntm-button",{staticClass:"mb-6",attrs:{title:"Добавить изображение",outlined:"",disabled:e.loading},on:{click:function(t){return t.preventDefault(),e.loadImageClickHandler(t)}}})],1),e._v(" "),r("ntm-button",{staticClass:"mb-6",attrs:{title:"Разместить",disabled:e.loading||!e.tagText.length,loading:e.loading},on:{click:function(t){return t.preventDefault(),e.createTag(t)}}})],1)],1)}),[],!1,null,"b6c51784",null),F=D.exports;f()(D,{NtmButton:r(380).default}),f()(D,{VAlert:A.a,VFileInput:k.a,VForm:j.a,VTextarea:O.a});var E={middleware:["auth","geoAlreadyGranted"],components:{createTagForm:F},headerData:{title:"Тегнуть"},btnValue:{value:"tag-create"}},S=Object(c.a)(E,(function(){var e=this.$createElement;return(this._self._c||e)("createTagForm")}),[],!1,null,null,null);t.default=S.exports}}]);